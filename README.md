# circlib

Python library for creating and editing CircloO levels

**Install**

```bash
pip install git+https://github.com/qaptivator/circlib.git
```

This library is under reworking, so the documentation is work in progress.

# Contributing

first of all, read the glossary, i wouldnt want confusion in the code.
use pull requests to merge changes. and feel free to contribute!!

# Glossary

- level code - level stored in a string, which you can see by exporting a level. this is what is read by the library, and then generated back again.
- line - a line of text, which is extracted by separating level code by newlines.
- parts (line parts) - all of the strings and numbers generated by splitting a line with a space.
- code (line code) - the first line option, which specifies the option's type. it can be an object, header, etc.
- numerics, strings - in CircloO, order of line parts matters for each data type.
  so if you have two numerics and a string, you can swap the places of strings and numerics: you just need to keep the order of numerics and strings indiidually correct.
  example: `ic 'io' 1385 2063 1` same as `ic 1385 'io' 2063 1` BUT not same as `ic 2063 1385 'io' 1`.
- options - an object holding arguments for a function, or holding generic properties of things. example: all lines share same properties so there is LineOptions.
  plus it allows to better document data.
- deserialize - convert a line/line parts into instance of an object.
- serialize - convert instance of a object to level code.
- object - a visible thing existing in the level. something like code for collectable sound effect is NOT an object, but a collectable IS.
- header - metadata attached to the object. it doesn't describe properties of an object, it describes properties of the level.
- object property (?) - a line which describes properties of an object, neither an object or a header (exception for comments (lines starting with '/')).
- type - do not use types as referring to object's code, or as a object itself.
  refer to it as 'object' (about an instance) or 'code' (inside of level code).
  calling 'c' or 'fixed_cirlce' a type is INCORRECT (ive done this many times myself here but i wanna change this)
- moveable - a moveable object, DO NOT USE MOVABLE.
- rotateable - only rotateable.

# ARCHIVE

This library is under reworking, so the documentation is work in progress.

# Usage

Here are some examples of how you can use this library.
You can parse an arleady existing level:

```py
from circlib import Level

level = Level.parse('your level string')
level.create_object("fixed_rectangle", ["1563", "1368", "102", "52", "0"])
print(level.stringify())
```

Or create a new one from scratch:

```py
level = Level()
level.create_object("fixed_rectangle", ["1500", "1300", "50", "50", "45"])
```

**Note:** strings which are not numbers in the properties of the object automatically get surrounded by '' (quotes). It does not happen when you add a newline to the start of the prop, for example: `\nnoanim`. This can be used for multi-line properties like forementioned `noanim`, or for trigger collectibles like `trigger`.

# API

## class Level

- Level.headers -- Headers of the level. For example: color, gravity, total circles. It is a dictionary.
- Level.objects -- Objects of the level. Not recommended to change it manually, use the provided methods instead. It is a list of Object class instances.

- Level.parse(str) -- A static method. Create a new level by parsing level's string. Returns a new Level object with all the headers and objects.
- Level.stringify() -- Returns the stringified version of the level, which can be imported in-game.
- Level.get_object_by_id(id) -- Returns an object with matching it. Be aware that in CircloO levels, ids are numbers, not strings.
- Level.get_object_by_type(type) -- Returns every object with matching type. See all types in the further section.
- Level.create_object(type, props, connections?) -- Creates a new object and returns it. Type and props are necessary, but connections is only needed for connectable objects, like ropes.
- Level.remove_object(object) -- Removes an object by giving it an Object instance.
- Level.remove_object_by_id(id) - Removes an object which matches the id.

## class Object

- Object. id -- Object's integer id, not a string.
- Object.type -- Object's type as a string. See all types in the further section.
- Object.props -- Array of every object's prop. It is stuff like position or rotation. P.S. there isn't any documentation of every prop of every object.
- Object.get_connections() -- Returns every connection of the object, such as two objects connected by a rope. If the object isn't an connectable, it throws an error.

## Object types

Format: object type -> corresponding type in the level's text file

- fixed_circle -> c
- fixed_rectangle -> b
- triangle -> t
- line -> l_at
- arc -> / LE_ARC_DESCRIPTION
- bezier_curve -> curve
- growing_circle -> gc
- growing_rectangle -> rGr
- movable_circle -> mcG
- movable_rectangle -> mb
- movable_triangle -> mtG
- superglue_connection -> GLUE
- rope_connection -> r
- pulley_connection -> p
- hinge_connection -> hinge
- prismatic_connection -> pr
- rotatable_rectangle -> rr
- rotatable_circle -> rc
- springy_rectangle -> wr
- ball_generator -> tmc
- box_generator -> tmb
- portal -> portal
- start -> y
- collectable -> ic
- special_connection -> spc

## Header types

- totalCircles -> totalCircles
- editorTool -> / EDITOR_TOOL
- editorView -> / EDITOR_VIEW
- edit -> / EDT
- gravity -> grav
- levelscriptVersion -> levelscriptVersion
- colors -> COLORS

## Collectable types

- regular -> i
- regular_collision -> io
- gravity -> ig
- gravity_collision -> im
- size -> is
- size_collision -> iso
- disconnect -> irb
- disconnect_collision -> irbo
- speed -> ips
- speed_collision -> ipso
- special -> isp
- special_collision -> ispo
